/*! halftone 2015-05-06 */
!function(a){var b={Mean:function(a,b,c){return(a+b+c)/3},Standard:function(a,b,c){return.2126*a+.7152*b+.0722*c},PerceivedA:function(a,b,c){return.299*a+.587*b+.114*c},PerceivedB:function(a,b,c){return Math.sqrt(Math.pow(.241*a,2)+Math.pow(.691*b,2)+Math.pow(.068*c,2))}};a.fn.halftone=function(b){if(!0!==this.is("canvas"))throw new Error("This plugin can only be applied to canvas elements!");var b=b||{},c=a.extend({},a.fn.halftone.defaults,b);this.css("background-color",c.background),"Standard"!=c.luminosity&&a.fn.halftone.setLuminosity(c.luminosity);var d=this[0].getContext("2d",{alpha:!1});d.fillStyle=c.color,this.data("srcImageData",e);var e=d.getImageData(0,0,this[0].width,this[0].height);if(null!==c.topleft){c.topleft[0],c.topleft[1]}var f=this[0].width,g=this[0].height;if(null!==c.bottomright)var f=c.bottomright[0],g=c.bottomright[1];var h=a.fn.halftone.matrixFromContext(d,f,g,c.sample);return 0==c.zoomfactor&&(c.sample=Math.ceil(this[0].width/h[0].length)),d=a.fn.halftone.draw(d,f,g,c.sample,h),this},a.fn.halftone.defaults={background:"#000000",color:"#ffffff",luminosity:"Standard",topleft:null,bottomright:null,zoomfactor:null,sample:8},a.fn.halftone.lMethods=b,a.fn.halftone.Luminance=b.Standard,a.fn.halftone.setLuminance=function(c){return"function"==typeof c&&(a.fn.halftone.Luminance=c),c in b?(a.fn.halftone.Luminance=b[c],!0):!1},a.fn.halftone.matrixFromContext=function(b,c,d,e){for(var f=[],g=Math.ceil(c/e),h=Math.ceil(d/e),i=0;h>i;i++){f[i]=[];for(var j=0;g>j;j++){var k=b.getImageData(0+j*e,0+i*e,e,e);f[i][j]=a.fn.halftone.getAreaLuminosity(k)}}return f},a.fn.halftone.spawnMatrix=function(a,b){for(var c=[],d=0;a>d;d++){c[d]=[];for(var e=0;b>e;e++)c[d][e]=void 0}return c},a.fn.halftone.matrixFromimgData=function(b,c){for(var d=Math.ceil(b.width/c),e=Math.ceil(b.height/c),f=Array.apply(null,Array(d)),g=f.map(function(a,b){return{r:0,g:0,b:0,a:0}}),h=a.fn.halftone.spawnMatrix(e,d),i=c*c*255,j=0,k=0,l=0,m=0;m<b.data.length;m+=4){try{g[j].r+=b.data[m],g[j].g+=b.data[m+1],g[j].b+=b.data[m+2],g[j].a+=b.data[m+3]}catch(n){alert(n.message)}0!=m&&m%(4*c)==0&&((l+1)%c==0&&(h[k][j]=a.fn.halftone.Luminance(g[j].r/i,g[j].g/i,g[j].b/i)),j++),0!=m&&m%(4*b.width)==0&&((l+1)%c==0&&(g=f.map(function(a,b){return{r:0,g:0,b:0,a:0}}),k++),l++,j=0)}return h},a.fn.halftone.getAreaLuminosity=function(b){for(var c=b.width*b.height*255,d=0,e=0,f=0,g=0,h=0;h<b.data.length;h+=4)d+=b.data[h],e+=b.data[h+1],f+=b.data[h+2],g+=b.data[h+3];var i=a.fn.halftone.Luminance(d/c,e/c,f/c);return i},a.fn.halftone.draw=function(a,b,c,d,e){{var f,g,h=d/2;Math.PI+Math.PI/2}for(a.clearRect(0,0,b,c),f=0;f<e.length;++f)for(g=0;g<e[f].length;++g){var i=0+g*d+h,j=0+f*d+h;a.beginPath(),a.arc(i,j,h*e[f][g],0,2*Math.PI,!0),a.fill()}return a},a.fn.halftone.sethalftoneRes=function(b,c){var d=a(b).data("srcImageData"),e=a.fn.halftone.matrixFromimgData(d,c),f=b[0].getContext("2d",{alpha:!1});f=a.fn.halftone.draw(f,b.width(),b.height(),c,e)},a.fx.step.halftoneRes=function(b){a.fn.halftone.sethalftoneRes(b.elem,b.now+b.end)},a.cssNumber.halftoneRes=!0}(jQuery);